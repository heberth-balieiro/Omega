unit UFuncaoSql;

interface

uses
  windows, Forms, Controls, SysUtils, SqlExpr, DBGrids, Grids, Graphics, ComCtrls, Classes;

type
  TFuncaoSql = class
    public
      class procedure CorGrid(Sender: TObject; const Rect: TRect; DataCol: Integer; Column: TColumn;
      State: TGridDrawState; Color: TColor);
    class function MontarSql(objeto: TObject) : String; overload;
  end;

implementation

{ TFuncaoSql }

class procedure TFuncaoSql.CorGrid(Sender: TObject; const Rect: TRect;
  DataCol: Integer; Column: TColumn; State: TGridDrawState; Color: TColor);
begin

end;

class function TFuncaoSql.MontarSql(objeto: TObject): String;
var
	VPosicaoFinal  : Integer;
	VCorpoSQL      : String;
	VSqlComponents : String;
begin
	VSqlComponents := TSQLDataSet(objeto).CommandText;
	VPoFinal        := POS('WHERE', UpperCase(VSqlComponents)) - 1;

	if (VPosicaoFinal <= 0) then
		VPosicaoFinal := length(VSqlComponente);

	VCorpoSQL := Copy(VSqlComponente, 1, VPosicaoFinal ) + ' ' ;

	Result := VCorpoSQL;
end;

end.
